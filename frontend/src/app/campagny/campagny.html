<p>campagny works!</p>

<!-- ğŸ” Recherche -->
<input
  type="text"
  [(ngModel)]="searchTerm"
  placeholder="ğŸ” Rechercher un problÃ¨me..."
  (input)="onSearchChange()"
  style="margin-bottom: 10px; padding: 6px;"
/>
<!-- âŒ Bouton pour vider -->
  <button
    *ngIf="searchTerm"
    (click)="clearSearch()"
    title="Effacer"
  >
    âœ–
  </button>
<h1>Liste Campagny</h1>
<!-- â• Bouton ajout -->
<button (click)="showPopup = true" style="margin-top: 15px;">â• Ajouter</button>

<h2>ğŸ“‹ Liste des compagnies</h2>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <!-- Si la liste est vide -->
    <tr *ngIf="filteredCampagny().length === 0">
      <td colspan="3" style="text-align: center;">La liste est vide</td>
    </tr>
    <!-- Sinon, affiche les campagnes -->
    <tr *ngFor="let campagny of filteredCampagny()">
      <td>{{ campagny.id }}</td>
      <td >{{ campagny.name }}</td>

      <td>
        <button (click)="openEditPopup(campagny)">âœ</button> 
        <button (click)="askDelete(campagny.id!)">ğŸ—‘</button>
      </td>
    </tr>
  </tbody>
</table>

<!-- ğŸ“„ Pagination -->
<div *ngIf="pageCount > 1" style="margin-top: 10px;">
  <button *ngFor="let p of [].constructor(pageCount); let i = index"
          (click)="goToPage(i)"
          [disabled]="i === currentPage"
          style="margin-right: 5px;">
    {{ i + 1 }}
  </button>
</div>

<!-- Popup ajout -->
<div *ngIf="showPopup" class="popup-box">
  <h3>Ajouter un Campagny</h3>
  <input
    type="text"
    [(ngModel)]="newCampagny.name"
    placeholder="Nom de la compagnie"
    style="width: 100%; padding: 6px;"
  />
  <div style="margin-top: 10px;">
    <button (click)="addCampagny()">âœ… Ajouter</button>
    <button (click)="showPopup = false">âŒ Annuler</button>
  </div>
</div>
<div *ngIf="showPopup" class="popup-overlay"></div>


<!-- Popup campagne existe dÃ©jÃ  Update-->
<div *ngIf="showAlreadyExistsPopupUpdate" class="popup-box">
  <h3>La campagne existe dÃ©jÃ  !</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeAlreadyExistsPopupUpdate()">OK</button>
  </div>
</div>
<div *ngIf="showAlreadyExistsPopupUpdate" class="popup-overlay"></div>

<!-- Popup campagne existe Ajout -->
<div *ngIf="showAlreadyExistsPopup" class="popup-box">
  <h3>La campagne existe dÃ©jÃ  !</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeAlreadyExistsPopupAdd()">OK</button>
  </div>
</div>
<div *ngIf="showAlreadyExistsPopup" class="popup-overlay"></div>



<!-- POPUP DE CONFIRMATION -->
<div
  *ngIf="showPopupSuppression"
  style="
    position: fixed; top: 20%; left: 35%; width: 30%; background: white;
    padding: 20px; border: 1px solid #ccc; box-shadow: 0 0 10px #999;
    z-index: 1000;
  "
>
  <h3>Voulez-vous vraiment supprimer cette campagne ?</h3>
  <div style="margin-top: 10px;">
    <button (click)="confirmDelete()">Confirmer</button>
    <button (click)="cancelDelete()">Annuler</button>
  </div>
</div>
<!-- Optionnel, pour griser le fond -->
<div
  *ngIf="showPopupSuppression"
  style="
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.1); z-index: 999;
  "
></div>


<!-- POPUP Champ vide Update-->
<div
  *ngIf="showEmptyFieldPopupUpdate"
  style="
    position: fixed; top: 20%; left: 35%; width: 30%; background: white;
    padding: 20px; border: 1px solid #ccc; box-shadow: 0 0 10px #999;
    z-index: 1000;
  "
>

  <h3>Le champ est vide !</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeEmptyFieldPopupUpdate()">OK</button>
  </div>
</div>

<div
  *ngIf="showEmptyFieldPopup"
  style="
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.1); z-index: 999;
  "
></div>

<!-- Popup champ vide Ajout-->
<div *ngIf="showEmptyFieldPopup" class="popup-box">
  <h3>Le champ est vide !</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeEmptyFieldPopup()">OK</button>
  </div>
</div>
<div *ngIf="showEmptyFieldPopup" class="popup-overlay"></div>



<!-- Popup succÃ¨s -->
<div *ngIf="showSuccessPopup" class="popup-box">
  <h3>Ajout avec succÃ¨sâ€¯!</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeSuccessPopup()">OK</button>
  </div>
</div>
<div *ngIf="showSuccessPopup" class="popup-overlay"></div>




<!-- Popup succÃ¨s modification -->
<div *ngIf="showEditSuccessPopup" class="popup-box">
  <h3>Modification avec succÃ¨sâ€¯!</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeEditSuccessPopup()">OK</button>
  </div>
</div>
<div *ngIf="showEditSuccessPopup" class="popup-overlay"></div>

<!-- Popup succÃ¨s suppression -->
<div *ngIf="showDeleteSuccessPopup" class="popup-box">
  <h3>Suppression avec succÃ¨sâ€¯!</h3>
  <div style="margin-top: 10px;">
    <button (click)="closeDeleteSuccessPopup()">OK</button>
  </div>
</div>
<div *ngIf="showDeleteSuccessPopup" class="popup-overlay"></div>



<!-- Popup de Modiffication-->
<div *ngIf="showEditPopup" class="popup-box">
  <h3>Modifier la campagne</h3>
  <input [(ngModel)]="editedName" placeholder="Nom de la campagne" />
  <div>
    <button [disabled]="!editId" (click)="updateCampagny(editId!, editedName)">ğŸ’¾ Enregistrer</button>
    <button (click)="closeEditPopup()">âŒ Annuler</button>
  </div>
</div>